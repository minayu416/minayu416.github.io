(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{7324:function(e,t,n){Promise.resolve().then(n.bind(n,9609)),Promise.resolve().then(n.bind(n,8294)),Promise.resolve().then(n.t.bind(n,2445,23)),Promise.resolve().then(n.t.bind(n,5935,23))},5205:function(e,t,n){"use strict";n.d(t,{E:function(){return p},NS:function(){return u},PB:function(){return h},eK:function(){return E},is:function(){return f},lZ:function(){return y}}),n(7437),n(2265);var r=n(3107),a=n(7815),o=n.n(a),i=n(3482),c=n(678);let u={time:{IP:8,GOOGLE:5},mode:{IP:"accounts.limitationInfo.accountType.guest",GOOGLE:"accounts.limitationInfo.accountType.google"}},l=async e=>{let t="".concat(e.ip,"-").concat(e.network,"-").concat(e.region,"-").concat(e.city,"-").concat(e.latitude,"-").concat(e.longitude),n=o().createHash("sha256").update(t).digest("hex");return"IP_".concat(n)},s=async()=>{try{let e=await r.Z.get("https://ipapi.co/json/");return{userId:await l(e.data),name:"Guest Mode",photo:"",accountType:"IP",additional:e.data}}catch(e){return console.error("Error fetching location:",e),null}},d=async e=>{let t=o().createHash("sha256").update(e.uid).digest("hex");return{userId:"GOOGLE_".concat(t),name:e.displayName,photo:e.photoURL,accountType:"GOOGLE",additional:{uid:e.uid,email:e.email,phone:e.phoneNumber}}},f=async e=>{try{let t=await fetch(c.Jk+"/api/v2/web/accounts",{method:"POST",body:JSON.stringify({lang:"",category:"accounts",action:"check",data:e})});if(!t.ok)throw Error("Network response was not ok");return await t.json()}catch(e){throw console.error("Error calling API:",e),e}},p=async()=>{try{return await i.I8.authStateReady(),i.I8.currentUser?await d(i.I8.currentUser):await s()}catch(e){return console.error("Error fetching User ID",e),null}},y=async e=>{let t=new Date().toISOString(),n={lang:"",category:"accounts",action:"deduct",data:{userId:e.userId,resetTime:t}};try{let e=await fetch(c.Jk+"/api/v2/web/accounts",{method:"POST",body:JSON.stringify(n)});if(!e.ok)throw Error("Network response was not ok");return await e.json()}catch(e){throw console.error("Error calling API:",e),e}},h=async e=>{try{let t=await f(e.state.userInfo);if(e.state.userData.counts!==t.counts&&await e.handleUpdateUser(),t&&t.counts>0)return t;return!1}catch(e){throw console.error("Error calling API:",e),e}},E=()=>{let e=new Date;return e.setUTCDate(e.getUTCDate()+1),e.setUTCHours(1,0,0,0),e.toLocaleString()}},3482:function(e,t,n){"use strict";n.d(t,{I8:function(){return i},lv:function(){return u},qj:function(){return c}});var r=n(6142),a=n(2730);let o=(0,r.ZF)({apiKey:"AIzaSyCvAvCTm_JOWKTE1GhDaWVK4no5yOkAgWc",authDomain:"miri-database.firebaseapp.com",projectId:"miri-database",storageBucket:"miri-database.appspot.com",messagingSenderId:"625470425985",appId:"1:625470425985:web:c11cdee1a3d3e699337680",measurementId:"G-85MY7Z9XT2"}),i=(0,a.v0)(o),c=()=>{let e=new a.hJ;(0,a.rh)(i,e).then(e=>{}).catch(e=>{console.log(e)})},u=()=>{i.signOut().then(()=>{console.log("Signed out successfully")}).catch(e=>{console.error("Sign out error:",e)})}},678:function(e,t,n){"use strict";n.d(t,{$f:function(){return d},F1:function(){return u},Jk:function(){return o},Q2:function(){return r},Tl:function(){return a},U6:function(){return l},tq:function(){return s}});let r="Ver. 2.1.6",a="max-w-screen-sm",o="https://miri-backend.vercel.app",i="MIRI",c="client",u="".concat(i,".").concat(c,".userDrawResult"),l="".concat(i,".").concat(c,".userDivinationRecord"),s="".concat(i,".").concat("sys",".spreadsData"),d={1:"▲",2:"▼",3:"⏹︎"}},9609:function(e,t,n){"use strict";n.r(t),n.d(t,{UserPathProvider:function(){return l},useUserPath:function(){return u}});var r=n(7437),a=n(2265);let o={userPath:"",lang:"en",inRoute:"",inStep:"",selectedMethod:"",selectedSpread:"",capableSelectCounts:"",isDivinationGuideMode:!1},i=(e,t)=>{switch(t.type){case"SET_LANG":return{...e,lang:t.payload};case"SET_PATH":return{...e,userPath:t.payload};case"SET_ROUTE":return{...e,inRoute:t.payload};case"SET_STEP":return{...e,inStep:t.payload};case"SET_METHOD":return{...e,selectedMethod:t.payload};case"SET_SPREAD":return{...e,selectedSpread:t.payload};case"SET_SELECT_COUNTS":return{...e,capableSelectCounts:t.payload};case"SET_GUIDE_MODE":return{...e,isDivinationGuideMode:t.payload};case"CLEAR_PATH":return o;default:return e}},c=(0,a.createContext)(),u=()=>(0,a.useContext)(c),l=e=>{let{children:t}=e,[n,u]=(0,a.useReducer)(i,o);return(0,r.jsx)(c.Provider,{value:{state:n,setLang:e=>{u({type:"SET_LANG",payload:e})},setPath:e=>{u({type:"SET_PATH",payload:e})},setRoute:e=>{u({type:"SET_ROUTE",payload:e})},setStep:e=>{u({type:"SET_STEP",payload:e})},setMethod:e=>{u({type:"SET_METHOD",payload:e})},setSpread:e=>{u({type:"SET_SPREAD",payload:e})},setSelectCounts:e=>{u({type:"SET_SELECT_COUNTS",payload:e})},setIsGuideMode:e=>{u({type:"SET_GUIDE_MODE",payload:e})},clearPath:()=>{u({type:"CLEAR_PATH"})}},children:t})}},8294:function(e,t,n){"use strict";n.r(t),n.d(t,{UserProvider:function(){return f},useUser:function(){return d}});var r=n(7437),a=n(2265),o=n(5205);let i=async e=>await (0,o.is)(e),c=async()=>await (0,o.E)(),u={userInfo:null,userData:null,loading:!1,error:null};function l(e,t){switch(t.type){case"DETECT_USER_ID":return{...e,loading:!0,userInfo:t.payload};case"FETCH_START":return{...e,loading:!0,error:null};case"FETCH_USER_DATA":return{...e,loading:!1,userData:t.payload};case"FETCH_ERROR":return{...e,loading:!1,error:t.error};default:return e}}let s=a.createContext(null),d=()=>(0,a.useContext)(s),f=e=>{let{children:t}=e,[n,o]=(0,a.useReducer)(l,u);(0,a.useEffect)(()=>{(async()=>{o({type:"FETCH_START"});try{let e=await c();o({type:"DETECT_USER_ID",payload:e});let t=await i(e);o({type:"FETCH_USER_DATA",payload:t})}catch(e){o({type:"FETCH_ERROR",error:"Failed to fetch user data"})}})()},[]);let d=async()=>{o({type:"FETCH_START"});try{let e=await c();o({type:"DETECT_USER_ID",payload:e});let t=await i(e);o({type:"FETCH_USER_DATA",payload:t})}catch(e){o({type:"FETCH_ERROR",error:"Failed to fetch user data"})}},f=async()=>{o({type:"FETCH_START"});try{let e=await i(n.userInfo);o({type:"FETCH_USER_DATA",payload:e})}catch(e){o({type:"FETCH_ERROR",error:"Failed to fetch updated data"})}};return(0,r.jsx)(s.Provider,{value:{state:n,handleUpdateUser:f,handleInitializeUser:d},children:t})}},3313:function(e,t){"use strict";let n;Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{DOMAttributeNames:function(){return r},isEqualNode:function(){return o},default:function(){return i}});let r={acceptCharset:"accept-charset",className:"class",htmlFor:"for",httpEquiv:"http-equiv",noModule:"noModule"};function a(e){let{type:t,props:n}=e,a=document.createElement(t);for(let e in n){if(!n.hasOwnProperty(e)||"children"===e||"dangerouslySetInnerHTML"===e||void 0===n[e])continue;let o=r[e]||e.toLowerCase();"script"===t&&("async"===o||"defer"===o||"noModule"===o)?a[o]=!!n[e]:a.setAttribute(o,n[e])}let{children:o,dangerouslySetInnerHTML:i}=n;return i?a.innerHTML=i.__html||"":o&&(a.textContent="string"==typeof o?o:Array.isArray(o)?o.join(""):""),a}function o(e,t){if(e instanceof HTMLElement&&t instanceof HTMLElement){let n=t.getAttribute("nonce");if(n&&!e.getAttribute("nonce")){let r=t.cloneNode(!0);return r.setAttribute("nonce",""),r.nonce=n,n===e.nonce&&e.isEqualNode(r)}}return e.isEqualNode(t)}function i(){return{mountedInstances:new Set,updateHead:e=>{let t={};e.forEach(e=>{if("link"===e.type&&e.props["data-optimized-fonts"]){if(document.querySelector('style[data-href="'+e.props["data-href"]+'"]'))return;e.props.href=e.props["data-href"],e.props["data-href"]=void 0}let n=t[e.type]||[];n.push(e),t[e.type]=n});let r=t.title?t.title[0]:null,a="";if(r){let{children:e}=r.props;a="string"==typeof e?e:Array.isArray(e)?e.join(""):""}a!==document.title&&(document.title=a),["meta","base","link","style","script"].forEach(e=>{n(e,t[e]||[])})}}}n=(e,t)=>{let n=document.getElementsByTagName("head")[0],r=n.querySelector("meta[name=next-head-count]"),i=Number(r.content),c=[];for(let t=0,n=r.previousElementSibling;t<i;t++,n=(null==n?void 0:n.previousElementSibling)||null){var u;(null==n?void 0:null==(u=n.tagName)?void 0:u.toLowerCase())===e&&c.push(n)}let l=t.map(a).filter(e=>{for(let t=0,n=c.length;t<n;t++)if(o(c[t],e))return c.splice(t,1),!1;return!0});c.forEach(e=>{var t;return null==(t=e.parentNode)?void 0:t.removeChild(e)}),l.forEach(e=>n.insertBefore(e,r)),r.content=(i-c.length+l.length).toString()},("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},5935:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{handleClientScriptLoad:function(){return E},initScriptLoader:function(){return _},default:function(){return S}});let r=n(6921),a=n(1884),o=n(7437),i=r._(n(4887)),c=a._(n(2265)),u=n(7484),l=n(3313),s=n(2185),d=new Map,f=new Set,p=["onLoad","onReady","dangerouslySetInnerHTML","children","onError","strategy","stylesheets"],y=e=>{if(i.default.preinit){e.forEach(e=>{i.default.preinit(e,{as:"style"})});return}if("undefined"!=typeof window){let t=document.head;e.forEach(e=>{let n=document.createElement("link");n.type="text/css",n.rel="stylesheet",n.href=e,t.appendChild(n)})}},h=e=>{let{src:t,id:n,onLoad:r=()=>{},onReady:a=null,dangerouslySetInnerHTML:o,children:i="",strategy:c="afterInteractive",onError:u,stylesheets:s}=e,h=n||t;if(h&&f.has(h))return;if(d.has(t)){f.add(h),d.get(t).then(r,u);return}let E=()=>{a&&a(),f.add(h)},_=document.createElement("script"),T=new Promise((e,t)=>{_.addEventListener("load",function(t){e(),r&&r.call(this,t),E()}),_.addEventListener("error",function(e){t(e)})}).catch(function(e){u&&u(e)});for(let[n,r]of(o?(_.innerHTML=o.__html||"",E()):i?(_.textContent="string"==typeof i?i:Array.isArray(i)?i.join(""):"",E()):t&&(_.src=t,d.set(t,T)),Object.entries(e))){if(void 0===r||p.includes(n))continue;let e=l.DOMAttributeNames[n]||n.toLowerCase();_.setAttribute(e,r)}"worker"===c&&_.setAttribute("type","text/partytown"),_.setAttribute("data-nscript",c),s&&y(s),document.body.appendChild(_)};function E(e){let{strategy:t="afterInteractive"}=e;"lazyOnload"===t?window.addEventListener("load",()=>{(0,s.requestIdleCallback)(()=>h(e))}):h(e)}function _(e){e.forEach(E),[...document.querySelectorAll('[data-nscript="beforeInteractive"]'),...document.querySelectorAll('[data-nscript="beforePageRender"]')].forEach(e=>{let t=e.id||e.getAttribute("src");f.add(t)})}function T(e){let{id:t,src:n="",onLoad:r=()=>{},onReady:a=null,strategy:l="afterInteractive",onError:d,stylesheets:p,...y}=e,{updateScripts:E,scripts:_,getIsSsr:T,appDir:S,nonce:g}=(0,c.useContext)(u.HeadManagerContext),m=(0,c.useRef)(!1);(0,c.useEffect)(()=>{let e=t||n;m.current||(a&&e&&f.has(e)&&a(),m.current=!0)},[a,t,n]);let v=(0,c.useRef)(!1);if((0,c.useEffect)(()=>{!v.current&&("afterInteractive"===l?h(e):"lazyOnload"===l&&("complete"===document.readyState?(0,s.requestIdleCallback)(()=>h(e)):window.addEventListener("load",()=>{(0,s.requestIdleCallback)(()=>h(e))})),v.current=!0)},[e,l]),("beforeInteractive"===l||"worker"===l)&&(E?(_[l]=(_[l]||[]).concat([{id:t,src:n,onLoad:r,onReady:a,onError:d,...y}]),E(_)):T&&T()?f.add(t||n):T&&!T()&&h(e)),S){if(p&&p.forEach(e=>{i.default.preinit(e,{as:"style"})}),"beforeInteractive"===l)return n?(i.default.preload(n,y.integrity?{as:"script",integrity:y.integrity}:{as:"script"}),(0,o.jsx)("script",{nonce:g,dangerouslySetInnerHTML:{__html:"(self.__next_s=self.__next_s||[]).push("+JSON.stringify([n,{...y,id:t}])+")"}})):(y.dangerouslySetInnerHTML&&(y.children=y.dangerouslySetInnerHTML.__html,delete y.dangerouslySetInnerHTML),(0,o.jsx)("script",{nonce:g,dangerouslySetInnerHTML:{__html:"(self.__next_s=self.__next_s||[]).push("+JSON.stringify([0,{...y,id:t}])+")"}}));"afterInteractive"===l&&n&&i.default.preload(n,y.integrity?{as:"script",integrity:y.integrity}:{as:"script"})}return null}Object.defineProperty(T,"__nextScript",{value:!0});let S=T;("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},2445:function(){}},function(e){e.O(0,[691,218,494,971,69,744],function(){return e(e.s=7324)}),_N_E=e.O()}]);