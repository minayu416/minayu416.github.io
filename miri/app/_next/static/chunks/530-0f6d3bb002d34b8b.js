(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[530],{8637:function(e,t,n){var a={"./en/translation.json":[9272,649],"./tw/translation.json":[4589,589]};function r(e){if(!n.o(a,e))return Promise.resolve().then(function(){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t});var t=a[e],r=t[0];return n.e(t[1]).then(function(){return n.t(r,19)})}r.keys=function(){return Object.keys(a)},r.id=8637,e.exports=r},6530:function(e,t,n){"use strict";n.d(t,{Z:function(){return g}});var a=n(7437),r=n(8792),o=n(425),s=n(8024),c=n(7535),i=n(678),l=n(2265),u=n(8294),d=n(5205);let f={IP:{2:[30,35,60],1:[60,65,80]},GOOGLE:{2:[30,35,60],1:[60,65,80]},FULL:"rgba(38, 156, 196) 0%, rgba(13, 38, 97) 50%",EMPTY:"rgba(255, 255, 255, 0.25) 90%, rgba(38, 156, 196) 95%, rgba(13, 38, 97) 97%"},h=e=>{let{userDataStatus:t,userState:n,t:r,handleMouseEnter:o,handleMouseLeave:s}=e;return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{onMouseEnter:o,onMouseLeave:s,className:"absolute -top-40 ".concat(t?"-right-52":"-right-36"," z-20 p-2 limiation-square rounded-lg border text-left cursor-default"),children:[n.userData?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("p",{className:"text-sm",children:[r("accounts.limitationInfo.yourAccountType"),r(d.NS.mode[n.userData.accountType])]}),(0,a.jsx)("p",{className:"text-sm",children:r("accounts.limitationInfo.resetTime")}),(0,a.jsx)("p",{className:"text-sm mb-2",children:(0,d.eK)()})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{className:"text-sm",children:r("accounts.limitationInfo.notFoundAccount1")}),(0,a.jsx)("p",{className:"text-sm mb-2",children:r("accounts.limitationInfo.notFoundAccount2")})]}),(0,a.jsxs)("p",{className:"text-sm",children:["*",r("accounts.limitationInfo.guestInfo")]}),(0,a.jsxs)("p",{className:"text-sm",children:["*",r("accounts.limitationInfo.registerInfo")]})]})})},m=e=>{let{userDataStatus:t,userData:n,t:r,handleMouseEnter:o,handleMouseLeave:s,handleClick:c}=e,[i,u]=(0,l.useState)(f.EMPTY);return(0,l.useEffect)(()=>{if(n){if(n.counts===n.totalCounts)u(f.FULL);else if(0===n.counts)u(f.EMPTY);else if(999===n.totalCounts)u(f.FULL);else{let e=f[n.accountType][n.counts];u("rgba(255, 255, 255, 0.25) ".concat(e[0],"%, rgba(38, 156, 196) ").concat(e[1],"%, rgba(13, 38, 97) ").concat(e[2],"%"))}}},[n]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{onMouseEnter:o,onMouseLeave:s,onClick:c,className:"absolute -top-[5.5rem] z-10 ".concat(t?"cursor-default":"cursor-pointer"),children:(0,a.jsx)("div",{className:"h-28 w-28 border-2 rounded-full grid place-items-center",style:{borderColor:"#f8d781",background:"rgba(53, 53, 119)"},children:(0,a.jsx)("div",{className:"h-full w-full rounded-full grid place-items-center",style:{background:"linear-gradient(to bottom, ".concat(i,", rgba(42, 111, 197) 100%)")},children:(0,a.jsx)("div",{className:"h-20 w-20 rounded-full grid place-items-center",children:(0,a.jsxs)("div",{children:[n?(0,a.jsxs)("p",{className:"text-xl",children:[n.counts,"/",n.totalCounts]}):(0,a.jsx)("p",{className:"text-xl",children:"0/0"}),(0,a.jsx)("p",{className:"text-sm",children:r("accounts.limitationInfo.counts")})]})})})})}),(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)("div",{className:"h-6 w-14 rounded-lg absolute -bottom-[2.3rem] z-0",style:{backgroundColor:"#f8d781"}})})]})},p=e=>{let{lng:t}=e,{t:n}=(0,o.$)(t),{state:r}=(0,u.useUser)(),[s,c]=(0,l.useState)(!1),i=!r.userInfo||!r.userData,d=()=>c(!0),f=()=>c(!1),p=()=>{};return(0,l.useEffect)(()=>{i?c(!0):c(!1)},[r.userData,r.userInfo]),(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"flex flex-col items-center relative",children:[s&&(0,a.jsx)(h,{userDataStatus:i,userState:r,t:n,handleMouseEnter:i?p:d,handleMouseLeave:i?p:f}),(0,a.jsx)(m,{userDataStatus:i,userData:r.userData,t:n,handleMouseEnter:i?p:d,handleMouseLeave:i?p:f,handleClick:i?p:()=>c(e=>!e)})]})})};var g=function(e){let{lng:t}=e,{t:n}=(0,o.$)(t);return(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{className:"".concat(i.Tl," mx-auto h-24 border-t navbar-color fixed inset-x-0 bottom-0"),children:(0,a.jsx)("div",{className:"",children:(0,a.jsxs)("div",{className:"grid grid-cols-5 pt-4",children:[(0,a.jsx)("div",{className:"p-4 text-center font-bold main-font-color",children:(0,a.jsx)(r.default,{href:"/".concat(t,"/"),children:(0,a.jsxs)("button",{type:"button",children:[(0,a.jsx)("div",{className:"pb-1",children:(0,a.jsx)(s.G,{icon:c.L2e,size:"xl",style:{color:"#f8d781"}})}),n("home.navbar.home")]})})}),(0,a.jsx)("div",{className:"p-4 text-center font-bold main-font-color",children:(0,a.jsx)(r.default,{href:"/".concat(t,"/guide"),children:(0,a.jsxs)("button",{type:"button",children:[(0,a.jsx)("div",{className:"pb-1",children:(0,a.jsx)(s.G,{icon:c.FL8,size:"xl",style:{color:"#f8d781"}})}),n("home.navbar.guide")]})})}),(0,a.jsx)("div",{className:"p-4 text-center font-bold main-font-color",children:(0,a.jsx)(p,{lng:t})}),(0,a.jsx)("div",{className:"p-4 text-center font-bold main-font-color",children:(0,a.jsx)(r.default,{href:"/".concat(t,"/settings"),children:(0,a.jsxs)("button",{type:"button",children:[(0,a.jsx)("div",{className:"pb-1",children:(0,a.jsx)(s.G,{icon:c.gr5,size:"xl",style:{color:"#f8d781"}})}),n("home.navbar.settings")]})})}),(0,a.jsx)("div",{className:"p-4 text-center font-bold main-font-color",children:(0,a.jsx)(r.default,{href:"/".concat(t,"/about"),children:(0,a.jsxs)("button",{type:"button",children:[(0,a.jsx)("div",{className:"pb-1",children:(0,a.jsx)(s.G,{icon:c.DBf,size:"xl",style:{color:"#f8d781"}})}),n("home.navbar.about")]})})})]})})})})}},5205:function(e,t,n){"use strict";n.d(t,{E:function(){return h},NS:function(){return i},PB:function(){return p},eK:function(){return g},is:function(){return f},lZ:function(){return m}}),n(7437),n(2265);var a=n(3107),r=n(7815),o=n.n(r),s=n(3482),c=n(678);let i={time:{IP:8,GOOGLE:5},mode:{IP:"accounts.limitationInfo.accountType.guest",GOOGLE:"accounts.limitationInfo.accountType.google"}},l=async e=>{let t="".concat(e.ip,"-").concat(e.network,"-").concat(e.region,"-").concat(e.city,"-").concat(e.latitude,"-").concat(e.longitude),n=o().createHash("sha256").update(t).digest("hex");return"IP_".concat(n)},u=async()=>{try{let e=await a.Z.get("https://ipapi.co/json/");return{userId:await l(e.data),name:"Guest Mode",photo:"",accountType:"IP",additional:e.data}}catch(e){return console.error("Error fetching location:",e),null}},d=async e=>{let t=o().createHash("sha256").update(e.uid).digest("hex");return{userId:"GOOGLE_".concat(t),name:e.displayName,photo:e.photoURL,accountType:"GOOGLE",additional:{uid:e.uid,email:e.email,phone:e.phoneNumber}}},f=async e=>{try{let t=await fetch(c.Jk+"/api/v2/web/accounts",{method:"POST",body:JSON.stringify({lang:"",category:"accounts",action:"check",data:e})});if(!t.ok)throw Error("Network response was not ok");return await t.json()}catch(e){throw console.error("Error calling API:",e),e}},h=async()=>{try{return await s.I8.authStateReady(),s.I8.currentUser?await d(s.I8.currentUser):await u()}catch(e){return console.error("Error fetching User ID",e),null}},m=async e=>{let t=new Date().toISOString(),n={lang:"",category:"accounts",action:"deduct",data:{userId:e.userId,resetTime:t}};try{let e=await fetch(c.Jk+"/api/v2/web/accounts",{method:"POST",body:JSON.stringify(n)});if(!e.ok)throw Error("Network response was not ok");return await e.json()}catch(e){throw console.error("Error calling API:",e),e}},p=async e=>{try{let t=await f(e.state.userInfo);if(e.state.userData.counts!==t.counts&&await e.handleUpdateUser(),t&&t.counts>0)return t;return!1}catch(e){throw console.error("Error calling API:",e),e}},g=()=>{let e=new Date;return e.setUTCDate(e.getUTCDate()+1),e.setUTCHours(1,0,0,0),e.toLocaleString()}},3482:function(e,t,n){"use strict";n.d(t,{I8:function(){return s},lv:function(){return i},qj:function(){return c}});var a=n(6142),r=n(2730);let o=(0,a.ZF)({apiKey:"AIzaSyCvAvCTm_JOWKTE1GhDaWVK4no5yOkAgWc",authDomain:"miri-database.firebaseapp.com",projectId:"miri-database",storageBucket:"miri-database.appspot.com",messagingSenderId:"625470425985",appId:"1:625470425985:web:c11cdee1a3d3e699337680",measurementId:"G-85MY7Z9XT2"}),s=(0,r.v0)(o),c=()=>{let e=new r.hJ;(0,r.rh)(s,e).then(e=>{}).catch(e=>{console.log(e)})},i=()=>{s.signOut().then(()=>{console.log("Signed out successfully")}).catch(e=>{console.error("Sign out error:",e)})}},678:function(e,t,n){"use strict";n.d(t,{$f:function(){return d},F1:function(){return i},Jk:function(){return o},Q2:function(){return a},Tl:function(){return r},U6:function(){return l},tq:function(){return u}});let a="Ver. 2.1.6",r="max-w-screen-sm",o="https://miri-backend.vercel.app",s="MIRI",c="client",i="".concat(s,".").concat(c,".userDrawResult"),l="".concat(s,".").concat(c,".userDivinationRecord"),u="".concat(s,".").concat("sys",".spreadsData"),d={1:"▲",2:"▼",3:"⏹︎"}},8294:function(e,t,n){"use strict";n.r(t),n.d(t,{UserProvider:function(){return f},useUser:function(){return d}});var a=n(7437),r=n(2265),o=n(5205);let s=async e=>await (0,o.is)(e),c=async()=>await (0,o.E)(),i={userInfo:null,userData:null,loading:!1,error:null};function l(e,t){switch(t.type){case"DETECT_USER_ID":return{...e,loading:!0,userInfo:t.payload};case"FETCH_START":return{...e,loading:!0,error:null};case"FETCH_USER_DATA":return{...e,loading:!1,userData:t.payload};case"FETCH_ERROR":return{...e,loading:!1,error:t.error};default:return e}}let u=r.createContext(null),d=()=>(0,r.useContext)(u),f=e=>{let{children:t}=e,[n,o]=(0,r.useReducer)(l,i);(0,r.useEffect)(()=>{(async()=>{o({type:"FETCH_START"});try{let e=await c();o({type:"DETECT_USER_ID",payload:e});let t=await s(e);o({type:"FETCH_USER_DATA",payload:t})}catch(e){o({type:"FETCH_ERROR",error:"Failed to fetch user data"})}})()},[]);let d=async()=>{o({type:"FETCH_START"});try{let e=await c();o({type:"DETECT_USER_ID",payload:e});let t=await s(e);o({type:"FETCH_USER_DATA",payload:t})}catch(e){o({type:"FETCH_ERROR",error:"Failed to fetch user data"})}},f=async()=>{o({type:"FETCH_START"});try{let e=await s(n.userInfo);o({type:"FETCH_USER_DATA",payload:e})}catch(e){o({type:"FETCH_ERROR",error:"Failed to fetch updated data"})}};return(0,a.jsx)(u.Provider,{value:{state:n,handleUpdateUser:f,handleInitializeUser:d},children:t})}},425:function(e,t,n){"use strict";n.d(t,{$:function(){return f}});var a=n(1505),r=n(2265),o=n(2635),s=n(4457),c=n(5350),i=n(1520);let l=["en","tw"],u="translation",d="i18next";function f(e,t,n){let[a,c]=(0,s.fP)([d]),i=(0,o.$G)(t,n),{i18n:l}=i;{let[t,n]=(0,r.useState)(l.resolvedLanguage);(0,r.useEffect)(()=>{t!==l.resolvedLanguage&&n(l.resolvedLanguage)},[t,l.resolvedLanguage]),(0,r.useEffect)(()=>{e&&l.resolvedLanguage!==e&&l.changeLanguage(e)},[e,l]),(0,r.useEffect)(()=>{a.i18next!==e&&c(d,e,{path:"/"})},[e,a.i18next])}return i}a.ZP.use(o.Db).use(i.Z).use((0,c.Z)((e,t)=>n(8637)("./".concat(e,"/").concat(t,".json")))).init({...function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u;return{supportedLngs:l,fallbackLng:"en",lng:e,fallbackNS:u,defaultNS:u,ns:t}}(),lng:void 0,detection:{order:["path","htmlTag","cookie","navigator"]},preload:[]})}}]);